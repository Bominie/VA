[
  {
    "path": "posts/2022-04-25-hw2/",
    "title": "Take home Exercise 2 ",
    "description": "Recreate Take-home Exercise 1 prepared by your classmate",
    "author": [
      {
        "name": "Bomin Kim",
        "url": {}
      }
    ],
    "date": "2022-04-28",
    "categories": [],
    "contents": "\n\n\nbody{ /* Normal  */\n      font-size: 12px;\n  }\ntd {  /* Table  */\n  font-size: 8px;\n}\nh1.title {\n  font-size: 38px;\n}\nh1 { /* Header 1 */\n  font-size: 28px;\n}\nh2 { /* Header 2 */\n    font-size: 22px;\n}\nOverview\nI have chosen HW1 from Aloysius Teng to be the base our this project. Since his project had its main focus on Joviality, and in HW2 I will expend this study further. This HW2 will demonstrate and explore two main purposes: 1. The distribution of selected factors, which is an intrinsic characteristic; 2. The single factor relationship between Y=Joviality and X=these factors.\nThe factors studied here are: 1. House size 2. Have kids 3. Age (agegroup) 4. Education level 5. Interest group 6. wage (incomegroup) 7. expense (expensegroup) 8. Checkin locations (funfactor)\nAmong which, 6.+7. come from data FinancialJournal.csv; 8. comes from CheckinJournal.csv. Due to the size+loading time limitation, I have rewrote these into simplier .rds files. Below are the methodologies for the 6.+7.+8: wage = “Wage” under column “category” expense = sum(“Education”,“Food”,“Shelter”,“Recreation”) under column “category” Checkin = sumif column “Venue Type”\n\n\npackages = c('tidyverse', 'ggdist', 'gghalves', 'ggridges','knitr', 'ggpubr')\nfor(p in packages){\n  if(!require(p, character.only = T)){\n    install.packages(p)\n  }\n  library(p, character.only = T)\n}\n\n\n\nRead Files\n\n\nparticipants <- read_csv(\"Data/Participants.csv\")\nwage <- read_rds(\"data/wage.rds\")\nexpense <- read_rds(\"data/expense.rds\")\ncheckin <- read_rds(\"data/Checkin.rds\")\n\n\n\nMerge Files\n\n\ndf <- participants %>% right_join(wage,by=c(\"participantId\"))\ndf <- df %>% right_join(expense,by=c(\"participantId\"))\ndf <- df %>% right_join(checkin,by=c(\"participantId\"))\n\n\n\nAnalysis\nPart 1. Joviality distribution\nThe original density graph already served the purpose well. The total joviality distribution is somewhat uniform, with an average of 0.4938. I have added the mean line to indicate that.\n\n\nggplot(data=df, \n       aes(x = df$joviality)) +\n  geom_density() +\n  geom_vline(xintercept=mean(df$joviality),color=\"red\")+\n  geom_text(aes(0.5,1, label = round(mean(df$joviality),4), hjust = 0))+\n  ggtitle(\"Figure 1: Joviality Distribution\")+\n  xlab(\"joviality\")+ylab(\"density\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nPart 2. Joviality vs Having kids\nThe original density graph already also served the purpose well. The joviality distribution between having kids or not does not differ much, participants that have kids have on average slightly higher joviality than participants don’t. I have added the mean lines of each to indicate that.\nThe code chunk below finds the conditional average.\n\n\njoviality_havekid_yes<-filter(df,haveKids == 1)\navg_joviality_havekids_yes=mean(joviality_havekid_yes$joviality)\njoviality_havekid_no<-filter(df,haveKids == 0)\navg_joviality_havekids_no=mean(joviality_havekid_no$joviality)\n\n\n\nFig. 2 with mean lines added.\n\n\nggplot(df, \n       aes(x = joviality, \n           colour = haveKids)) +\n  geom_density() +\n  geom_vline(xintercept=avg_joviality_havekids_yes,color=\"pink\")+\n  geom_vline(xintercept=avg_joviality_havekids_no,color=\"lightblue\")+\n  geom_text(aes(0.5,0.8, label = round(avg_joviality_havekids_yes,4)), color=\"red\", hjust = 0)+\n  geom_text(aes(0.5,0.9, label = \"mean(yeshavekids)\"), color=\"red\", hjust = 0)+\n  geom_text(aes(0.5,0.8, label = round(avg_joviality_havekids_no,4)), color=\"blue\",hjust = 1)+\n  geom_text(aes(0.5,0.9, label = \"mean(nohavekids)\"), color=\"blue\", hjust = 1)+\n  ggtitle(\"Figure 2: Joviality vs Having kids\")+\n  ylab(\"density\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nPart 3. Joviality vs Household Size\nThe original Boxplot + Violin plot has demonstrated well, no further enhancement is needed. Household of 2 or 3 on average has slightly higher joviality than household of 1.\n\n\nggplot(df,aes(y = joviality,x= as.character(householdSize))) +\n  xlab(\"house hold size\") +\n  geom_violin(fill=\"light blue\") +\n  geom_boxplot(alpha=0.5) + \n  stat_summary(geom = \"point\", fun.y=\"mean\", colour =\"red\",size=2) +\n  ggtitle(\"Figure 3: Joviality vs Household Size\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nPart 4. Joviality vs age (agegroup)\nThe original scatter plot indeed showed no dependency between joviality and age with abysmal R square statistics. However, once agegorup has been categorized, we can find some differences.\n\n\nggplot(df, aes(x= age, y=joviality)) +\n  geom_point() +\n  geom_smooth(method=\"lm\", size=0.5) +\n  stat_regline_equation(label.y = 1.1, aes(label = ..rr.label..)) +\n  ggtitle(\"Figure 4-1: Joviality vs age\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nThe code chunk below categorizes age into 4 groups.\n\n\ndf<-df%>%mutate(agegroup=case_when(age<30~\"30 below\",\n                                    age>=30 &age<40~\"30-39\",\n                                    age>=40 &age<50~\"40-49\",\n                                    age>=50 ~\"50 and above\"))\ndf1<-df%>% group_by(agegroup,joviality)\n\n\n\nBelow has indicated that the average of joviality decreases along with age.\n\n\nggplot(df,aes(y = joviality,x= agegroup)) +\n  xlab(\"age group\") +\n  geom_violin(fill=\"light blue\") +\n  geom_boxplot(alpha=0.5) + \n  stat_summary(geom = \"point\", fun.y=\"mean\", colour =\"red\",size=2) +\n  ggtitle(\"Figure 4-2: Joviality vs Age Group\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nPart 5. Joviality vs Education Level\nThe original Boxplot + Violin plot has demonstrated this point well, no further enhancement is needed.\nBelow has indicated joviality increases with education level.\n\n\ndf2<-df %>% mutate(educationLevel = fct_relevel(educationLevel, \n            \"Low\", \"HighSchoolOrCollege\", \"Bachelors\", \n            \"Graduate\"))\n  ggplot(df2,aes(y = joviality,x= educationLevel)) +\n    xlab(\"education level\") +\n    geom_violin(fill=\"light blue\") +\n    geom_boxplot(alpha=0.5) + \n    stat_summary(geom = \"point\", fun.y=\"mean\", colour =\"red\",size=2) +\n    ggtitle(\"Figure 5: Joviality vs Education Level\")+\n    theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nPart 6. Joviality vs Interest Group\nThe original Boxplot + Violin plot has demonstrated this point well, no further enhancement is needed. Until we find how the interest group is defined, no qualitative conclusion can be drawn.\n\n\nggplot(df, aes(y = joviality, \n             x= reorder(interestGroup, joviality, FUN = mean))) +\n  xlab(\"interest group\") +\n  geom_boxplot() +\n  stat_summary(geom = \"point\",\n                 fun.y=\"mean\",\n                 colour =\"red\",\n                 size=2) +\n  stat_summary(geom = \"text\",\n               aes(label=paste(\"mean=\",round(..y..,2))),\n               fun.y=\"mean\",\n               colour=\"red\",\n               size=2,\n               vjust = -2) +\n  ggtitle(\"Figure 6: Joviality vs Interest Group\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nPart 7. Joviality vs Wage\nThe scatter plot below has indicated joviality and wage has little dependency, with such low R square, we can almost conclude these two factors are not linearly dependent.\n\n\nggplot(df, \n       aes(x= wage, \n           y=joviality)) +\n  geom_point() +\n  geom_smooth(method=\"lm\", \n              size=0.5) +\n  stat_regline_equation(label.y = 1.1, aes(label = ..rr.label..)) +\n  ggtitle(\"Figure 7: Joviality vs Wage\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nPart 8. Joviality vs Expense\nBelow scatter plot has shown there is a negative trend between these two factors. We will take a closer look.\n\n\nggplot(df, \n       aes(x= expense, \n           y=joviality)) +\n  geom_point() +\n  geom_smooth(method=\"lm\", \n              size=0.5) +\n  stat_regline_equation(label.y = 1.1, aes(label = ..rr.label..)) +\n  ggtitle(\"Figure 8-1: Joviality vs Expense\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nBefore we can most definitely define “expense” for FinancialJournal.csv (I have some doubt to just use the summation of the four), we need to exclude the outliers, ie. the participants with expense that are close to 0. I have here defined the expense criteria to be more than 1000 (< -1000). Below has indicated a R square of 0.3, we can conclude there is dependency between these two.\n\n\ndf4 <- filter(df, expense< -1000)\nggplot(df4, \n       aes(x= expense, \n           y=joviality)) +\n  geom_point() +\n  geom_smooth(method=\"lm\", \n              size=0.5) +\n  stat_regline_equation(label.y = 1.1, aes(label = ..rr.label..)) +\n  ggtitle(\"Figure 8-2: Joviality vs Wage\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nBelow single factor regression statistic has shown adj. R square = 0.2971. As well as small enough P values, again indicating Y=joviality is statistic significantly depending on X=expense. This is a good finding! :)\n\n\ndf_joviality.expense.lm <- lm(joviality ~ expense, data = df4)\nsummary(df_joviality.expense.lm)\n\n\n\nCall:\nlm(formula = joviality ~ expense, data = df4)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.52949 -0.17693 -0.01365  0.16183  0.81356 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -1.292e-01  3.189e-02   -4.05 5.57e-05 ***\nexpense     -2.802e-05  1.452e-06  -19.30  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2409 on 878 degrees of freedom\nMultiple R-squared:  0.2979,    Adjusted R-squared:  0.2971 \nF-statistic: 372.5 on 1 and 878 DF,  p-value: < 2.2e-16\n\nPart 9. Joviality vs Checkin Locations\n9.1 First, I want to present the distribution of such “Checkin Locations” against the previous 7 factors.\nBelow code chuck categorizes low/mid/high income&expense with 0%-25%/25%-75%/75%-100% quantiles for further demonstration purpose.\n\n\ndf<-df%>%\n  mutate(incomegroup=case_when(wage<quantile(df$wage,probs=c(.25))~\"Low Income\",\n  df$wage>=quantile(df$wage,probs=c(.25))&wage<quantile(df$wage,probs=c(.75))~\"Mid Income\",\n  df$wage>=quantile(df$wage,probs=c(.75)) ~\"High Income\"))\ndf<-df%>%\n  mutate(expensegroup=case_when(expense<quantile(df$expense,probs=c(.25))~\"High Expense\",\n  df$expense>=quantile(df$expense,probs=c(.25))&expense<quantile(df$expense,probs=c(.75))~\"Mid Expense\",\n  df$expense>=quantile(df$expense,probs=c(.75)) ~\"Low Expense\"))\n\n\n\nBelow code chuck regroup Checkin Locations with the previous 7 factors for demonstration purpose.\n\n\ng1 <- df %>%\n  select(c(\"householdSize\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>% \n  group_by(householdSize)%>% \n  summarise(across(c(\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\"),~mean(.x,na.rm=TRUE)))\ng1_1<-g1 %>%\n  select(c(\"householdSize\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>%\n  pivot_longer(c(Apartment,Pub,Restaurant,Workplace), names_to = \"type\", values_to = \"value\")\n\ng2 <- df %>%\n  select(c(\"haveKids\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>% \n  group_by(haveKids)%>% \n  summarise(across(c(\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\"),~mean(.x,na.rm=TRUE)))\ng2_1<-g2 %>%\n  select(c(\"haveKids\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>%\n  pivot_longer(c(Apartment,Pub,Restaurant,Workplace), names_to = \"type\", values_to = \"value\")\n\ng3 <- df %>%\n  select(c(\"agegroup\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>% \n  group_by(agegroup)%>% \n  summarise(across(c(\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\"),~mean(.x,na.rm=TRUE)))\ng3_1<-g3 %>%\n  select(c(\"agegroup\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>%\n  pivot_longer(c(Apartment,Pub,Restaurant,Workplace), names_to = \"type\", values_to = \"value\")\n\ng4 <- df %>%\n  select(c(\"educationLevel\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>% \n  group_by(educationLevel)%>% \n  summarise(across(c(\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\"),~mean(.x,na.rm=TRUE)))\ng4_1<-g4 %>%\n  select(c(\"educationLevel\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>%\n  pivot_longer(c(Apartment,Pub,Restaurant,Workplace), names_to = \"type\", values_to = \"value\")\ng4_2<-g4_1 %>% mutate(educationLevel = fct_relevel(educationLevel, \n            \"Low\", \"HighSchoolOrCollege\", \"Bachelors\", \n            \"Graduate\"))\n\ng5 <- df %>%\n  select(c(\"interestGroup\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>% \n  group_by(interestGroup)%>% \n  summarise(across(c(\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\"),~mean(.x,na.rm=TRUE)))\ng5_1<-g5 %>%\n  select(c(\"interestGroup\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>%\n  pivot_longer(c(Apartment,Pub,Restaurant,Workplace), names_to = \"type\", values_to = \"value\")\n\ng6 <- df %>%\n  select(c(\"incomegroup\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>% \n  group_by(incomegroup)%>% \n  summarise(across(c(\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\"),~mean(.x,na.rm=TRUE)))\ng6_1<-g6 %>%\n  select(c(\"incomegroup\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>%\n  pivot_longer(c(Apartment,Pub,Restaurant,Workplace), names_to = \"type\", values_to = \"value\")\ng6_2<-g6_1 %>% mutate(incomegroup = fct_relevel(incomegroup, \"Low Income\", \"Mid Income\", \"High Income\"))\n\ng7 <- df %>%\n  select(c(\"expensegroup\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>% \n  group_by(expensegroup)%>% \n  summarise(across(c(\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\"),~mean(.x,na.rm=TRUE)))\ng7_1<-g7 %>%\n  select(c(\"expensegroup\",\"Apartment\", \"Pub\", \"Restaurant\", \"Workplace\")) %>%\n  pivot_longer(c(Apartment,Pub,Restaurant,Workplace), names_to = \"type\", values_to = \"value\")\ng7_2<-g7_1 %>% mutate(expensegroup = fct_relevel(expensegroup,\"Low Expense\", \"Mid Expense\", \"High Expense\"))\n\n\n\nFig. 9-1 to 9-7 show different distribution of Checkin Locations against the previous 7 factors.\n\n\nggplot(g1_1, aes(fill=type, y=value, x=householdSize)) + \n  geom_bar(position=\"stack\", stat=\"identity\")+\n  xlab(\"Household Size\") + ylab(\"avg. of location checkin\")+\n  theme(axis.title.y=element_text(angle=0,vjust = 0.5),axis.text = element_text(face=\"bold\"))+\n  ggtitle(\"Figure 9-1: Location Checkin vs household size\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\nggplot(g2_1, aes(fill=type, y=value, x=haveKids)) + \n  geom_bar(position=\"stack\", stat=\"identity\")+\n  xlab(\"Have Kids\") + ylab(\"avg. of location checkin\")+\n  theme(axis.title.y=element_text(angle=0,vjust = 0.5),axis.text = element_text(face=\"bold\"))+\n  ggtitle(\"Figure 9-2: Location Checkin vs Have Kids\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\nggplot(g3_1, aes(fill=type, y=value, x=agegroup)) + \n  geom_bar(position=\"stack\", stat=\"identity\")+\n  xlab(\"Age Group\") + ylab(\"avg. of location checkin\")+\n  theme(axis.title.y=element_text(angle=0,vjust = 0.5),axis.text = element_text(face=\"bold\"))+\n  ggtitle(\"Figure 9-3: Location Checkin vs Age Group\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\nggplot(g4_2, aes(fill=type, y=value, x=educationLevel)) + \n  geom_bar(position=\"stack\", stat=\"identity\")+\n  xlab(\"Educational Level\") + ylab(\"avg. of location checkin\")+\n  theme(axis.title.y=element_text(angle=0,vjust = 0.5),axis.text = element_text(face=\"bold\"))+\n  ggtitle(\"Figure 9-4: Location Checkin vs Educational Level\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\nggplot(g5_1, aes(fill=type, y=value, x=interestGroup)) + \n  geom_bar(position=\"stack\", stat=\"identity\")+\n  xlab(\"Interest Group\") + ylab(\"avg. of location checkin\")+\n  theme(axis.title.y=element_text(angle=0,vjust = 0.5),axis.text = element_text(face=\"bold\"))+\n  ggtitle(\"Figure 9-5: Location Checkin vs Interest Group\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\nggplot(g6_2, aes(fill=type, y=value, x=incomegroup)) + \n  geom_bar(position=\"stack\", stat=\"identity\")+\n  xlab(\"Income Group\") + ylab(\"avg. of location checkin\")+\n  theme(axis.title.y=element_text(angle=0,vjust = 0.5),axis.text = element_text(face=\"bold\"))+\n  ggtitle(\"Figure 9-6: Location Checkin vs Income Group\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\nggplot(g7_2, aes(fill=type, y=value, x=expensegroup)) + \n  geom_bar(position=\"stack\", stat=\"identity\")+\n  xlab(\"Expense Group\") + ylab(\"avg. of location checkin\")+\n  theme(axis.title.y=element_text(angle=0,vjust = 0.5),axis.text = element_text(face=\"bold\"))+\n  ggtitle(\"Figure 9-7: Location Checkin vs Expense Group\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\n9.2 By common sense, I suspect joviality should have a relation with the frequency that one goes to restaurants and bars. After all, this is what got me through Covid. Hereby I have designed the 9th factor, funfactor, that is a ratio of (Pub+Restaurant visit)/(total visits).\n\n\ndf<-df%>%\n  mutate(funfactor=(Pub+Restaurant)/(Apartment+Pub+Restaurant+Workplace))\n\n\n\nVoila! Guess girl is right! Below scatter plot shows positive correlation between joviality and fun factor.\n\n\nggplot(df, \n       aes(x= funfactor, \n           y=joviality)) +\n  geom_point() +\n  geom_smooth(method=\"lm\", \n              size=0.5) +\n  stat_regline_equation(label.y = 1.1, aes(label = ..rr.label..)) +\n  ggtitle(\"Figure 8: Joviality vs Fun Factor\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nBelow single factor regression statistics has once proven the dependency is statistic significant. With adj. R square at 0.1901 and small enough P vales.\n\n\ndf_joviality.funfactor.lm <- lm(joviality ~ funfactor, data = df)\nsummary(df_joviality.funfactor.lm)\n\n\n\nCall:\nlm(formula = joviality ~ funfactor, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.52208 -0.19557 -0.03731  0.17075  0.88447 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -0.64212    0.07835  -8.196 8.94e-16 ***\nfunfactor    2.96719    0.20762  14.291  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.258 on 865 degrees of freedom\n  (144 observations deleted due to missingness)\nMultiple R-squared:  0.191, Adjusted R-squared:  0.1901 \nF-statistic: 204.2 on 1 and 865 DF,  p-value: < 2.2e-16\n\nEnd Note:\nI was surprised by the talents that my classmates possess, and genuinely have learned a lot in these two exercises from them. The skeleton of this study that Aloysius provided gave a good base structure, thank you mate and thank you Google.\nSince Joviality aka Happiness, is such a fascinating and complex topic. A database with such size and valid inputs from multiple angles is ideal to quantify what happiness is made of. The final objective of this study should be a multi-factors linear regression model where Y=happiness, X=(not limited to) the above 8 factors.\n\n\n\n",
    "preview": "posts/2022-04-25-hw2/hw2_files/figure-html5/unnamed-chunk-4-1.png",
    "last_modified": "2022-05-03T14:26:06+08:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-04-25-hw1/",
    "title": "Take home Excercise 1 ",
    "description": "Demographic of Ohio USA, city of Engagement (VAST Challenge 2022) .",
    "author": [
      {
        "name": "Bomin Kim",
        "url": {}
      }
    ],
    "date": "2022-04-25",
    "categories": [],
    "contents": "\nOverview\nIn this exercise we will explore family of packages such as tidyverse and ggplot to create visual analysis of the demographic of city of Engagement Ohio,USA. By exploiting and practicing, we will be able to have better understanding of how to diversely analyze and plot data through R.\nLoading the required packages:\n\n\npackages = c('tidyverse', 'plotly', 'readxl', 'knitr', 'dplyr', 'ggplot2', \n             'grid')\n\nfor(p in packages){\n  if(!require(p, character.only = T)){\n    install.packages(p)\n  }\n  library(p, character.only = T)\n}\n\n\n\nPreparing Data\n1.Reading the data:\n\n\nparticipants <- read_csv(\"data/participants.csv\")\n\n\n\n\n\nFinancialJournal <- read_csv(\"data/FinancialJournal.csv\")\n\n\n\n2.Rename the columns\nWe will rename some column names for simplicity.\n\n\nparticipants <- participants %>%\n  rename('householdsize'='householdSize',\n         'havekids'='haveKids',\n         'educationlevel'='educationLevel',\n         'interestgroup'='interestGroup',\n         'Happiness'='joviality')\n\n\n\n3.Merge two dataframs\nWe will mainly use the data in “participants.csv”, but we will also use the wage data in “FinancialJournal.csv”.\n\n\nWage <- FinancialJournal %>%\n  filter(category == \"Wage\") %>%\n  group_by(participantId) %>%\n  select(participantId, amount) %>%\n  summarise(wage = mean(amount))\nwrite_rds(Wage,\"data/wage.rds\")\n\n\n\n\n\nwage<-read_rds(\"data/wage.rds\")\n\n\n\n\n\nparticipants <- merge(x = participants, y = wage[ ,c(\"participantId\",\"wage\")],\nby=\"participantId\", all.x=TRUE)\n\n\n\nNow we are done with data wrangling and can start analyzing!\nAge distribution\n1.First glimp of age distribution\nBelow is a simple age distribution among the participants:\n\n\nggplot(participants,aes(age,fill=havekids))+\n  geom_histogram(bins=(max(participants$age)-min(participants$age))/2,color=\"grey30\")+\n  ggtitle(\"Age distribution with kids status\")+\n  xlab(\"Age\")+ylab(\"# of Participants\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\n2.Categorizing age groups\nWe will dissect the age by every 10 years to further understand its distribution:\n\n\nparticipants<-participants%>%mutate(agegroup=case_when(age<30~\"Below 30\",\n                                    \n                                    age>=30 &age<40~\"30-39\",\n                                    age>=40 &age<50~\"40-49\",\n                                    age>=50 ~\"50 and above\"))\n\n\n\n3.Pie chart of age groups\n\n\npiedf <- participants %>% count(agegroup,sort=TRUE)\n\nggplot(piedf, aes(x=\"\", y=n, fill=agegroup)) +\n  geom_bar(stat=\"identity\", width=1, color=\"white\") +\n  coord_polar(\"y\", start=0) +\n  theme_void() +\n  geom_label(aes(label =n), \n             position = position_stack(vjust = 0.5), \n             show.legend = FALSE) +\n  scale_fill_brewer() +\n  ggtitle(\"Age Group in Ohio USA\") +\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nWe now have learned among the surveyees, the population is age wise evenly distributed.\nEducation level distribution\n1.Education level vs age groups\nWe know people of different generation received education differently due to various constraints. Below is a reflection of it.\n\n\nggplot(participants, aes(x=agegroup, fill=educationlevel))+\n  geom_bar()+\n  ggtitle(\"Educational level vs age groups\")+\n  xlab(\"Age Group\")+ylab(\"# of Participants\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nDue to each age group has total different number of people, we will normalize each group and find out the ratio of different education levels within age groups:\n\n\neduvsage<-participants%>%group_by(agegroup,educationlevel)%>%tally()\neduvsage<-eduvsage%>%\n  group_by(agegroup)%>%\n  mutate(Total=sum(n),percent=round(n*100/Total))%>%\n  ungroup()\nggplot(eduvsage, aes(x=agegroup, y=percent,fill=educationlevel))+\n  geom_col()+\n  xlab(\"Age Group\")+ylab(\"% of Participants\")+\n  ggtitle(\"Education level vs age groups in %\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\n2.Education level vs wage\nBelow is a distribution of wage based on different education levels.\n\n\nggplot(participants, aes(x=wage, fill=educationlevel))+\n  geom_histogram(color=\"grey30\")+\n  xlab(\"Income\")+ylab(\"# of Participants\")+\n  ggtitle(\"Education level vs income\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nAgain, we will to find out the ratio of education levels in different income class. I have defined income class as (low,mid,high) based on (<25%,25%<75%,>75%) of the income distribution.\n\n\nparticipants<-participants%>%mutate(incomegroup=case_when(wage<quantile(participants$wage,probs=c(.25))~\"Low Income\",wage>=quantile(participants$wage,probs=c(.25)) &wage<quantile(participants$wage,probs=c(.75))~\"Mid Income\",wage>=quantile(participants$wage,probs=c(.75)) ~\"High Income\"))\n\neduvswage<-participants%>%group_by(incomegroup,educationlevel)%>%tally()\neduvswage<-eduvswage%>%\n  group_by(incomegroup)%>%\n  mutate(Total=sum(n),percent=round(n*100/Total))%>%\n  ungroup()\nggplot(eduvswage, aes(x=incomegroup, y=percent,fill=educationlevel))+\n  geom_col()+\n  xlab(\"Income Group\")+ylab(\"% of Participants\")+\n  ggtitle(\"Education level vs income group in %\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\nDistribution of happiness\n1.Happiness vs interest group vs having kids\n\n\nggplot(participants,aes(y=Happiness,x=interestgroup))+\n  geom_boxplot()+\n  stat_summary(geom =\"point\") +\n  facet_grid(havekids ~.)+\n  xlab(\"Interest group\")+ylab(\"Happiness\")+\n  ggtitle(\"Happiness vs interest Groups vs having kids or not\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\n2.Happiness vs income group\n\n\nggplot(participants,aes(y=Happiness,x=incomegroup))+\n  geom_boxplot()+\n  stat_summary(geom =\"point\")+\n  xlab(\"Income group\")+ylab(\"Happiness\")+\n  ggtitle(\"Happiness vs income group\")+\n  theme(plot.title = element_text(hjust = 0.5))\n\n\n\n\n\n\n\n",
    "preview": "posts/2022-04-25-hw1/hw1_files/figure-html5/unnamed-chunk-8-1.png",
    "last_modified": "2022-05-03T14:23:51+08:00",
    "input_file": {}
  }
]
